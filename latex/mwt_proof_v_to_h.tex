%mwt_proof_v_to_h.tex

\subsection{V-Polyhedra $\to$ H-Polyhedra}
\paragraph{Overview}
This part of the paper, much like the last, will bring the diagram to life, but in the other direction.  Many of the steps are remarkably similar to the other direction (and they \textit{will} get remarks later), so, while all details are provided, they may be provided more directly.

\subsubsection{Relax: $\PV \to \CV$} 
Given $\PV = \cone(\U) \oplus \conv(\V)$, we need to relax this object to a cone.  We take each $\u_i \in \U \to \smallstack{0}{\u_i}$, and each $\v_j \in \V \to \smallstack{1}{\v_j}$.  Consider now:
  \[\CV = \cone\left(\left\{\stack{0}{\u_i}\right\} \cup 
                     \left\{\stack{1}{\v_j}\right\}\right)\]
Then $\PV = \pi^0(\CV \cap \{\smallstack{x_0}{\x} : x_0 = 1\})$.  That is, $\PV$ can be recovered by first intersecting $\CV$ with the hyperplane $\{\smallstack{x_0}{\x} : x_0 = 1\}$, then projecting to the original dimensions.  To prove this, note that 
\begin{align*}
& \u \in \cone(\U),\; \v \in \conv(\V) \Rightarrow \\
& \stack{1}{\u + \v} \in \CV \cap \left\{\stack{x_0}{\x} \Big| x_0 = 1\right\}
\end{align*}
So every element of $\PV$ has a representative in $\CV \cap \{\smallstack{x_0}{\x} : x_0 = 1\}$.  Furthermore,
\begin{align*}
& \stack{1}{\z} \in \CV \Rightarrow \\
& \exists \alpha_i, \beta_j \geq 0 \Suchthat \stack{1}{\z} = 
    \sum\nolimits_i \alpha_i \stack{0}{\u_i} + 
    \sum\nolimits_j \beta_j \stack{1}{\v_j} \Rightarrow \\
& \sum\nolimits_j \beta_j = 1
\end{align*}
So, every member of $\CV \cap \{\smallstack{x_0}{\x} : x_0 = 1\}$ is a sum of a conical combination of $\smallstack{\vec{0}}{\U}$ and a convex combination of $\smallstack{\vec{1}}{\V}$, so is represented in $\PV$.

\subsubsection{Lift: $\CV \to \CHp$}
The next task is to lift the cone $\CV$ to a represenation as an intersection of halfspaces.  This is a bit simpler than when we had to lift in the other direction.  

With a few rewrites of $\CV$ we get:
\begin{align*}
& \CV = \cone(\V') = \\
& \left\{ \x \Suchthat \exists t_i \geq 0 : \x = \sum\nolimits_i t_i \v_i\right\} = \\
& \left\{ \x \Suchthat \exists \t \geq 0 : \x = \V' \t \right\} = \\
\pi_{\x} & \left\{ \stack{\x}{\t} \Suchthat 
    (\vec{0}\; I) \stack{\x}{\t} \geq \vec{0},\;
    \begin{pmatrix*}[r] -I & \V' \\ I & -\V' \end{pmatrix*}
       \stack{\x}{\t} \leq \vec{0}
       \right\} = \\
 \pi_{\x} & \left\{ \stack{\x}{\t} \Suchthat  
\begin{pmatrix}
\vec{0} & -I  \\
-I      & \V' \\
I       & -\V'
\end{pmatrix}
  \stack{\x}{\t} \leq \vec{0}
\right\}
\end{align*}

Here, $\V'$ has been realized as not just a collection of column vectors, but also as a stack of row vectors, dual to what was seen in the previous lifting procedure.  So, the final expression gives us our cone as a projection of an H-Cone, this H-Cone will be denoted $\CHp$, and the projections will be considered in the next section.

\subsubsection{Drop: $\CHp \to \CH$}
As before, $\CHp$ will be dropped one dimension at a time, so the task is to project away the dimension $k$ from $A\x \leq \vec{0}$.  Let's dwell on this for a moment.  Say that $A\x \leq \vec{0}$, and $A\y \leq \vec{0}$.  Furthermore, suppose that $\pi^k(\x) = \pi^k(\y)$.  We need to ``collapse'' these two vectors into one representative.  Observe:
\begin{align*}
  \pi^k\CHp &= \pi^k\{\x \suchthat A\x \leq \vec{0}\} \\
            &= \{\pi^k\x \suchthat A\x \leq \vec{0}\} \\
            &= \{\x : x_k = 0 \suchthat \exists \alpha \in \R :\; 
                A(\x+\alpha\e_k)\ \leq \vec{0}\} \\
\end{align*}
Consider $A$ as a collection of row vectors $\a_i$.  Then, this final set can be written:
\begin{align*}
  &\{\x : x_k = 0 \suchthat \exists \alpha \in \R :\; 
                \forall i\; \dotproduct{\a_i}{\x+\alpha\e_k} \leq 0\} \\
  &\{\x : x_k = 0 \suchthat \exists \alpha \in \R :\; 
                \forall i\; \dotproduct{\a_i}{\x} \leq -\alpha\,a_i^k \}
\end{align*}

Now define:
  \begin{align*} \Z &= \{\a_i \in A \suchthat a_i^k = 0\} \\
                 \P &= \{\a_i \in A \suchthat a_i^k > 0\} \\
                 \N &= \{\a_i \in A \suchthat a_i^k < 0\} 
  \end{align*}
In what follows, let $\x' \in \CHp | x_k = 0$ (so I don't have to keep writing it).  We will now investigate what constraints rows from the sets $\Z$, $\P$, and $\N$ place on $\alpha$.   If all of these constraints can be simultaneously satisfied, then we will get an $\alpha$ that places $\x + \alpha\e_k$ in $\CHp$ and therefore $\x \in \pi^k(\CHp)$.  First suppose $\a_i \in \Z$.  Then $\dotproduct{\a_i}{\x} \leq -\alpha\,a_i^k = 0$ places no additional constraints on $\alpha$.  If $\dotproduct{\a_i}{\x} > 0$ then $\x$ is not in $\pi^k(\CHp)$, end of story.  

Next let $\a_i \in \P$.  Then we can choose any $\alpha$ satisfying: 
\[ \alpha \leq \dotproduct{-\a_i/a_i^k}{\x} \]
Similarly, let $\a_j \in \N$.  Then we can choose any $\alpha$ satisfying: 
\[ -\alpha \leq \dotproduct{\a_j/a_j^k}{\x} \]
Taken separately, either of these constraints can be satisfied with some arbitrarily large or small $\alpha$.  What is needed, however, is a way to take them into account at the same time.  Then, given some $\x$ from $\pi^k(\CHp)$, if we can satisfy all these constraints for all $i,j$, then we ought to be able to lift it back to $\CHp$.  It seems natural to add these inequalities together, leading to:
\begin{align*}
  0 \leq \dotproduct{-\a_i/a_i^k}{\x} &+ 
         \dotproduct{\a_j/a_j^k}{\x} \Leftrightarrow \\
  \dotproduct{-a_j^k \a_i}{\x} &+ 
         \dotproduct{a_i^k \a_j}{\x} \leq 0 \Leftrightarrow \\
  \dotproduct{a_i^k \a_j -a_j^k \a_i}{\x} &\leq 0 \Leftrightarrow \\
  \dotproduct{a_i^k \a_j}{\x} &\leq \dotproduct{a_j^k \a_i}{\x}
\end{align*}
Care must be taken when multiplying through by $a_j^k \in \N$, making sure to reverse the direction of inequalities.
Consider the last two forms.  
$\dotproduct{a_i^k \a_j -a_j^k \a_i}{\x} \leq 0$
is a positive linear combination of rows from $\CHp$, whose coefficient at $x_k$ is $0$.  This is a constraint that we can use as we ``project away'' the $k$-th coordinate. The second form
$\dotproduct{a_i^k \a_j}{\x} \leq \dotproduct{a_j^k \a_i}{\x}$
places a constraint on the $\alpha$ we may choose to ``lift'' our $x$ back to $\CHp$ after we apply $\pi^k(\CHp)$.

The same $\fjoink$ operator will be used as before.
  \[\P \fjoink \N = \{a^i_k\a_j - a^j_k\a_i \;|\; \a_i \in \P,\, \a_j \in \N \}\]

We'd like to let $A' = \pi^k(\Z \cup \P \fjoink \N)$, and claim that $\pi^k(\CHp) = \{\x \suchthat A'\x \leq 0\}$, but we need to make sure that 
\begin{align*}
  A\x \leq \vec{0} &\Rightarrow A'(\x - x_k \e_k) \leq \vec{0} \\
  A'\x' \leq \vec{0} &\Rightarrow 
        \exists \alpha \suchthat A(\x' + \alpha \e_k) \leq \vec{0}
\end{align*}
The first requirement states that, given a member of $\CHp$, it projects down to $\pi^k(\CHp)$.  The second states that, given a member of $\pi^k(\CHp)$, we can lift it back to $\CHp$.  

The first requirement is easily satisfied.
\begin{align*} 
&\quad A\x \leq \vec{0} \Rightarrow  \\
 (\forall \a_l \in \Z) &\quad \dotproduct{\a_l}{\x} \leq 0 \\
 (\forall \a_i \in \P, \forall \a_j \in \N)
     &\quad \dotproduct{\a_i}{\x} \leq 0,\, 
            \dotproduct{\a_j}{\x} \leq 0 \Rightarrow \\
 (\forall \a_i \in \P, \forall \a_j \in \N)
     &\quad \dotproduct{a_i^k \a_j - a_j^k \a_i}{\x} \leq 0 \Rightarrow \\
 (\forall \a_i \in \Z \cup \P \fjoink \N) 
     &\quad \dotproduct{\a_i}{\x} \leq 0 \Rightarrow \\
     &\quad \pi^k(\x) \in \pi^k(\CHp)
\end{align*}

The other requirement is a bit trickier, as we must calculate an $\alpha$ to meet our requirements.  Suppose that $A'\x' \leq \vec{0},\, x'_k = 0$, and let $\a_i \in \Z$:
\begin{align*}
\dotproduct{\a_i}{\x' + \alpha \e_k} 
            &= \dotproduct{\a_i}{\x'} + \alpha\dotproduct{\a_i}{\e_k} \\
            &= \dotproduct{\a_i}{\x'} + 0 \\
            &= \dotproduct{\a_i}{\x'} \leq 0
\end{align*}
As previously mentioned, the rows from $\Z$ do not constrain the value of $\alpha$.  Next, consider $\P$ and $\N$.
\begin{align*}
 (\forall \a_i \in \P, \forall \a_j \in \N) \\
     \quad \dotproduct{a_i^k \a_j - a_j^k \a_i}{\x'} &\leq 0 \Rightarrow \\
     \quad \dotproduct{a_i^k \a_j}{\x'} 
          &\leq \dotproduct{a_j^k \a_i}{\x'} \Rightarrow \\
     \quad \dotproduct{\a_i /a_i^k}{\x'}
          &\leq \dotproduct{\a_j /a_j^k}{\x'} \Rightarrow \\
     \exists \alpha \suchthat \dotproduct{\a_i /a_i^k}{\x'}
          &\leq \alpha \leq \dotproduct{\a_j /a_j^k}{\x'}
\end{align*}
So, we take an $\alpha$ that satisfies all pairs of the above constraints.  (Note: it is possible that no such $\alpha$ exists for any $\x'$, then our polyhedron is empty.  This is elegantly summarized in what is known as the Farkas Lemma, and will be discussed later).  Then, we plug $\alpha$ back into our original constraints:
\begin{align*}
  \dotproduct{\a_i}{\x' - \alpha \e_k} 
      &= \dotproduct{\a_i}{\x'} - \alpha\dotproduct{\a_i}{\e_k} \\
      &= \dotproduct{\a_i}{\x'} - \alpha\,a_i^k \\
      &= a_i^k(\dotproduct{\a_i/a_i^k}{\x'} - \alpha) \leq 0 \\
  \dotproduct{\a_j}{\x' - \alpha \e_k} 
      &= \dotproduct{\a_j}{\x'} - \alpha\dotproduct{\a_j}{\e_k} \\
      &= \dotproduct{\a_j}{\x'} - \alpha\,a_j^k \\
      &= a_j^k(\dotproduct{\a_j/a_j^k}{\x'} - \alpha) \leq 0
\end{align*}
The inequalities follow from the fact that $a_j^k < 0 < a_i^k$.  So the conclusion is that, given $A'\x' \leq \vec{0}$, we can find an $\alpha$ such that $A(\x'-\alpha\e_k) \leq \vec{0}$, and that $\pi^k(\CHp) = \{\x'\suchthat x'_k = 0,\, A'\x' \leq \vec{0}\}$.

Since we can project away one dimension, we can succesively form $\pi_{\x}(\CHp)$.  Then, we denote $\CH = \pi_{\x}(\CHp)$.

\subsubsection{Restrict: $\CH \to \PH$}
The last loose end to get back to our original polyhedron is to intersect $\CH$ with the hyperplane $\{\x \suchthat x_k = 0\}$.  This is simply:
\[ A\x \leq \vec{0},\, x_0 = 1 \to 
        \begin{pmatrix*}[r] 1 & \vec{0} \\ 
                            -1 & \vec{0} \\ 
                            \multicolumn{2}{c}{A} 
        \end{pmatrix*} 
      \x \leq \begin{pmatrix*}[r] 1 \\ -1 \\ \vec{0} \end{pmatrix*}
\]
This H-Polyhedron has been denoted $\PH$, and the construction is done.

\subsubsection{Summary}

