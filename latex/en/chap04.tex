\chapter{Testing}

In the next sections, the methods used for testing the program described above will be discussed.  It will be convenient to assume that sets representing row vectors and cone-generators do not contain $\0$.  This results in no loss of generality, only the annoyance of constantly assuming some triviality does not occur.

\paragraph{Notation:} Let $AU \leq \b$ be shorthand for $(\forall \u\in U) A\u \leq \b$.

\section{Testing H-Cone $\to$ V-Cone}
Suppose we have an H-Cone $C_A= \HC{A}$, and would like to test if a V-Cone $C_{V'} = \cone(V')$ represents the same set.  It's easy to check that
\[ AV'\leq\0 \Rightarrow C_{V'} \subseteq C_A\]
It's not clear what to do to check if $C_A\subseteq C_{V'}$.  Suppose we had a set $V$, and we knew that $C_A= \cone(V)$, and that $C_A= C_{V'} \Rightarrow V \subseteq V'$.  Then we'd have the following situation:
\begin{alignat*}{2}
	 & AV'\leq\0 \;      & \Rightarrow & \; C_{V'} \subseteq C_A \\
	 & V \subseteq V' \; & \Rightarrow & \; C_A\subseteq C_{V'}  \\
	 & C_{V'} = C_A \;   & \Rightarrow & \; V \subseteq V'       \\
	 & C_{V'} = C_A \;   & \Rightarrow & \; AV'\leq\0
\end{alignat*}

The problem is now to come up with such a set $V$, and to determine when such a set may or may not exist for a given cone.  We will need to relax the requirements on $V$ a little bit, but not in a way that reduces its utility.  First, we consider a \textit{minimal} set generating a cone.

\begin{Def}[Minimal Set]
	A set $V$ is called \textit{minimal} for $\cone(V)$ if
	\[ (\forall \v \in V)\; \cone(V\setminus\{\v\}) \subset \cone(V) \]
\end{Def}

\begin{Prop}\label{v_not_minimal}
	If a set $V$ is not minimal for $\cone(V)$ then
	\[\exists \v\in V,\, \t\geq\0,\, \v=V\e_i,\,\t\neq\e_i:\quad \v = V\t \]
	That is, there is a member of $V$ which is a non-trivial non-negative linear combination of elements of V.
\end{Prop}

\begin{proof}
	Say $\cone(V\setminus\{\v\}) = \cone(V)$ where $\v=V\e_i$.  Then $\exists \t\geq\0$ such that $\v=(V\setminus\{\v\})\t$.  Let $\t'$ be $\t$ with a $0$ in the position corresponding to $\v$ in $V$.  Then $\v=V\t$.
\end{proof}

Is the converse true?  That is, is it true that, if $V$ is minimal, then
\begin{equation}
	\t\geq\0,\,\v=V\e_i,\; [\v=V\t \Rightarrow \t=\e_i]\, \label{vmin_implies}
\end{equation}
Not quite.  There is one catch, if there is some
\begin{equation}
	\t\geq\0,\,\t\neq\0,\,V\t=\0  \label{not_pointed}
\end{equation}
then \eqref{vmin_implies} fails.  So, for what cones does \eqref{not_pointed} fail?  It turns out that there is a useful class of cones called \textit{pointed} having this property.

\begin{Def}[Vertex]
	Let $P$ be a polyhedron.  A point $\v \in P$ is called a \textit{vertex} if, for any $\u \neq \0$, at least one of the following is true:
	\begin{align*}
		\v + \u \not\in P \\
		\v - \u \not\in P
	\end{align*}
\end{Def}

\begin{Def}[Pointed Cones]
	A cone is called \textit{pointed} if it has a vertex.
\end{Def}

\begin{Prop} \label{v_is_pointed} The following statements are equivalent.
	\begin{enumerate}
		\item $\cone(V)$ is pointed.
		\item $\t\geq\0,\,\t\neq\0,\; [V\t=\0 \Rightarrow \t=\0]$
	\end{enumerate}
\end{Prop}

\begin{proof}
	First, observe that, due to \nameref{cone_closure}, if a cone has a vertex, then it is the origin.  Suppose that the origin is a vertex, but that (2) fails.  Since $\0\not\in V$, $\t$ has at least two non-zero elements, let one be $t_i$.  Then $\0 = V(t_i\e_i) + V(\t-t_i\e_i)$.  Let $\u=V(t_i\e_i$.  Clearly $\u\neq\0$, and also $\u,-\u\in C$.  Then the origin is not a vertex, a contradiction.

	Next, suppose that $\0$ is not a vertex, then $\exists\t_1,\t_2\geq\0$, $\t_{1,2}\neq\0$, $\u=V\t_1$, $-\u=V\t_2$.  Then $\t_1+\t_2\geq\0$, $\t_1+\t_2\neq\0$, and $V(\t_1+\t_2)=\0$.
\end{proof}

Now we can consider the converse of \Cref{v_not_minimal}.

\begin{Prop}[Minimal V-Cone Generators]\label{min_vcone_generators}
	Suppose that $\cone(V)$ is pointed.  Then the following two statements are equivalent:
	\begin{enumerate}
		\item V is minimal
		\item $\t\geq\0,\,\v=V\e_i,\; [\v=V\t \Rightarrow \t=\e_i]$
	\end{enumerate}
\end{Prop}

\begin{proof}
	$(\neg 1 \Rightarrow \neg 2)$ is \Cref{v_not_minimal}.  So suppose that $\t\geq\0,\,\v=V\e_i$, and $\v=V\t$.  If $0\leq t_i < 1$, then $\v = V(\t-t_i\e_i)/(1-t_i)$, and $\v\in \cone(V\setminus\{\v\} $, which would mean that $V$ is not minimal.  Suppose that $t_i\geq 1$.  Then $\t-\e_i\geq\0$, and $\0=V(\t-\e_i)$.  Because $V$ is pointed, by \Cref{v_is_pointed} $\0=\t-\e_i$, so $\t=\e_i$.
\end{proof}

\Cref{min_vcone_generators} gives us a way to characterize the minimal sets generating V-Cones.  Clearly, there is not a unique minimal set generating any V-Cone.  However, we can relax the requirement of unicity to equivalence, in the following way.

\begin{Def}[vector equivalence]
	Let $\u,\v \in \R^d$, non-zero, and suppose that $\u/\norm{\u} = \v/\norm{\v}$.  Then say that $\u,\v$ are \textit{equivalent}, and write $\u \simeq \v$.  If for every $\u\in U$ there is a $\v\in V$ such that $\u\simeq\v$, write $ U \sqsubseteq V$.  Write $U \simeq V$ if $U \sqsubseteq V$ and $V \sqsubseteq U$.
\end{Def}

\begin{Prop}\label{vector_equivalence}
	Then the following two statements are equivalent:
	\begin{enumerate}
		\item $\v\simeq\u$
		\item $(\exists t>0)\;\v=t\u$
	\end{enumerate}
\end{Prop}

\begin{proof}
	$(1\Rightarrow 2)$.  Let $t=\norm{\v}/\norm{\u}$.  Then $t>0$, and $\v=t\u$.\\
	$(2\Rightarrow 1)$.  $\v/\norm{\v} = t\u/\norm{t\u} = \u/\norm{\u}$
\end{proof}

We now show that the minimal sets generating pointed V-Cones are essentially unique.

\begin{Prop}[Minimal Generators of a Pointed Cone]\label{min_pointed_generators}
	Suppose that $V$ is minimal, and $\cone(V) = \cone(V')$ is pointed.  Then $V\sqsubseteq V'$.  It follows that if $V'$ is also minimal, then $V\simeq V'$.
\end{Prop}

We'll use this short lemma in the proof of the above proposition.

\begin{Lemma}\label{non_negative_sums_to_e}
	Suppose $A$ is a non-negative matrix, $\b\geq\0$, and $A\b = \e_i$.  Then there exists an $l$, $t>0$ such that $A(t\e_l) = \e_i$
\end{Lemma}

\begin{proof}
	Since $A$ and $\b$ are non-negative, the following holds:
	\begin{align}
		%&(\forall j,k\neq i)\; A_k^j > 0 \Rightarrow b_j = 0 \label{Ajk_neq_0}\\
		 & (\forall j,k\neq i)\; b_j   > 0 \Rightarrow A_k^j = 0 \label{bk_neq_0}
	\end{align}
	Since $A\b=\e_i$, there is some $b_l > 0$, and $A_k^l > 0$.  \eqref{bk_neq_0} shows that the entire column is zero except for the entry in row $i$, so $A(\e_l/A_k^l) = \e_i$.
\end{proof}

\begin{proof}[Proof of \Cref{min_pointed_generators}]
	Let $\v\in V$, $\v=V\e_i$.  If we can show that there is some $\v'\in V'$ such that $\v\simeq\v'$, then we're done.  Since $\cone(V)=\cone(V')$, there is a non-negative matrix $A$ such that $V'=VA$.  Furthermore, there is a non-negative vector $\b$ such that $\v=V'\b$.  Then $\v=V'\b=(VA)\b=V(A\b)$.  By \Cref{min_vcone_generators}, $A\b=\e_i$.  By \Cref{non_negative_sums_to_e}, there is a $t>0,l$ such that $A\b=A(t\e_l)$.  Then $\v=VA(t\e_l)=tV'\e_l=t\v'$ where $\v'\in V'$.  By \Cref{vector_equivalence}, $\v\simeq\v'$.
\end{proof}

So now we know that pointed cones have essentially unique generating sets.  We now turn to the question of using this knowledge to create a test for the program.  We suppose that we have a minimal generating set $V$ for some pointed V-Cone $C$, and have created a matrix $A$ so that $C = \HC{A} = \cone(V)$.  We run the program and get a set $V'$, and let $C'=\cone(V')$.  We must check that $C' = C$.
\begin{alignat*}{2}
	 & AV'\leq\0 \;        & \Rightarrow & \; C' \subseteq C   \\
	 & V \sqsubseteq V' \; & \Rightarrow & \; C \subseteq C'   \\
	 & C' = C \;           & \Rightarrow & \; V \sqsubseteq V' \\
	 & C' = C \;           & \Rightarrow & \; AV'\leq\0
\end{alignat*}

\begin{EqCriteria}[H-Cone $\to$ V-Cone]\label{eq_hc_vc}
	Say $V$ is a minimal generating set for the pointed V-Cone $C$, and suppose $C = \HC{A} = \cone(V)$.  Then
	\[ C = \cone(V') \;\Leftrightarrow\; AV'\leq\0,\, V \sqsubseteq V' \]
\end{EqCriteria}

\begin{Test}[H-Cone $\to$ V-Cone]\label{test_hc_to_vc}
	We now have a method for testing the program.  First, we hand-craft an H-Cone $\HC{A}$ based on minimal set $V$ for some pointed V-Cone. We then run our program to get a set $V'$, with the alleged property that $\cone(V') = \HC{A}$.  If we confirm \Cref{eq_hc_vc}, then our program has succeeded.
\end{Test}

\begin{Remark}
	Can we test the program for non-pointed cones?  Yes, but it is slightly more complicated.  Instead of prior knowledge of a minimal generating set for the cone, we also need to know what the largest linear subspace $L$ contained in the cone.  If we project away this linear subspace, then we will have a pointed cone.  Given another set $V'$, we may project away this subspace from $V'$ using a projection matrix, and use \Cref{test_hc_to_vc}.  Then we need to see if $\cone(V')$ spans $L$.  This can be done with a modified fourier-motzkin elimination, but unfortunately we are trying to test the implementation of fourier-motzkin elimination.

	It may still be worthwhile to do such tests, but it should be noted that a test isn't designed to prove a program correct, only prove it incorrect.  If we analyze the program well and test the fourier-motzkin elimination extensively, then the added complexity of the more general testing may not be worth it.  As of now this is left as a possible future extension of the program.
\end{Remark}

\begin{Remark}
	While not important for testing the program, one may ask if pointed V-Cones are the only cones with essentially unique generating sets.  The answer is no, for any line has an essentially unique generating set, but is not pointed.  However, this is the only exception.  It isn't hard to see that, given a non-pointed cone, if it occupies more than one-dimension, then it must at least occupy a half-plane, and a halfplane has uncountably many non-equivalent generators.  So, technically, the \Cref{test_hc_to_vc} would work for one-dimensional non-pointed cones (lines).
\end{Remark}

\section{Testing V-Cone $\to$ H-Cone}

In this section we create a method in the vein of \nameref{test_hc_to_vc}, but for testing the program transforming V-Cones to H-Cones.  This section is almost identical to the previous, with the exception of requiring the Farkas Lemma.

\begin{Def}[Minimal Set of Constraints]
	A set $A$ is called \textit{minimal} for $\HC{A}$ if
	\[ (\forall A_i \in A)\; \HC{A\setminus\set{A_i}} \supset \HC{A} \]
\end{Def}

\begin{Prop}\label{a_not_minimal}
	If a set $A$ is not minimal for $\HC{A}$ then
	\[\exists A_i\in A,\, \t\geq\0,\, A_i=\e_i^T A,\,\t\neq\e_i:\quad A_i = \t^T V \]
	That is, there is a member of $A$ which is a non-trivial non-negative linear combination of elements of V.
\end{Prop}

In order to prove \Cref{a_not_minimal}, we require the Farkas Lemma.

\subsection{Farkas Lemma}

\begin{Prop}[The Farkas Lemma]\label{farkas_lemma}
	Let $U \in \R^{d\times n}$.  Precisely one of the following is true:
	\begin{align*}
		 & (\exists \t \geq \0) : \x = U\t                \\
		 & (\exists \y) : U^T\y \leq 0,\; \ip{\x}{\y} > 0
	\end{align*}
\end{Prop}

\begin{proof}  That both can't be true can be seen by:
	\[ \x = U\t \quad\Rightarrow\quad \y^T\x = \y^T U\t \quad\Rightarrow\quad 0 \neq 0 \]
	To see that at least one is true we must reconsider the process of converting a V-Cone to an H-Cone.  First, from $\cone(U)$ we create the following matrix:
	\[ A = \begin{pmatrix*}[r] \0 & -I \\ I & -U \\ -I & U \end{pmatrix*}  \]
	By the way $A$ is constructed,
	\begin{equation}\label{eq:flcone}
		(\exists \t) : A \xt \leq \0 \Leftrightarrow (\exists \t\geq\0)\; \x = U\t
	\end{equation}
	In the proof of the transformation, we use \Nameref{fm_hcone} to transform that matrix $A$.  The \Nameref{fm_matrix} promises a sequence of matrices $Y_{d+1}, \dots, Y_{d+n}$ with certain properties.  Let $Y = (Y_{d+n})(Y_{d+(n-1)})\dots(Y_{d+1})$, then it can be said of $Y$:
	\begin{enumerate}
		\item Every element of $Y$ is non-negative.
		\item $Y$ is finite.
		\item The last $n$ columns of $YA$ are all $\0$.
		\item \((\exists t_{d+1},\dots,t_{d+n})A(\x + \sum_{i=d+1}^{d+n} t_i\e_i) \leq \0
		      \Leftrightarrow (YA)\x \leq \0 \)
	\end{enumerate}
	Note that here $\x \in \R^{d+n}$.  $A$ has three blocks of rows, which can be labeled with $Z,P,N$ in a fairly obvious way.  Then, $Y$ can be broken up into three blocks of columns, so that
	\[ Y = (Y_Z \; Y_P \; Y_N) \]
	Where each of $Y_Z,Y_P,Y_N \geq \0$.  Consolidating what is known about $A$ and $Y$,
	\[ YA = (Y_Z \; Y_P \; Y_N) \begin{pmatrix*}[r] \0 & -I \\ I & -U \\ -I & U \end{pmatrix*}
		= (Y' \; \0) \]
	Here, we have let $Y' = Y_P - Y_N$.  Then it follows that
	\[ \0 = -Y_Z - Y_P(U) + Y_N(U) = -Y_Z - Y'(U) \;\Rightarrow\; Y_Z = - Y'U
		\;\Rightarrow\; Y'U \leq \0 \]
	Then it holds that, for any row $\y' \in Y'$:
	\begin{equation}\label{eq:flneg}
		\y'U \leq \0
	\end{equation}
	It is also true that
	\[ (YA)\xt = (Y'\;\0)\xt = Y'\x \]
	We also have
	\begin{equation}\label{eq:flconst}
		(\exists \t) : A \xt \leq \0 \Leftrightarrow
		(YA)\xt \leq \0 \Leftrightarrow
		Y'\x \leq \0
	\end{equation}
	Note that here $\x \in \R^d$.  So, if given some $\x$, the left side of \eqref{eq:flconst} is not satisfied, then neither is the right, and there must be some row $\y' \in Y'$ such that the following holds:
	\begin{equation}\label{eq:flconstbrk} \ip{\y'}{\x} > 0 \end{equation}
	Then we conclude that, if the right side of \eqref{eq:flcone} fails, then there is a vector $\y' \in Y'$ satisfying \eqref{eq:flneg} and \eqref{eq:flconstbrk}.
\end{proof}

\begin{Remark}\label{valid_cone_ineq}
	\nameref{farkas_lemma} above can be equivalently stated:
	\[ (\exists \t \geq \0) : \t^T A = \y \quad\Leftrightarrow\quad
		\neg(\exists \x) : A\x \leq 0,\; \ip{\y}{\x} > 0 \]
	This way of writing it makes it clear that, if $\y^T\x\leq 0$ holds for some H-Cone $\HC{A}$, then $\y$ is a non-negative linear combination of the rows of $A$.
\end{Remark}

\hrule

\begin{proof}[Proof of \Cref{a_not_minimal}]
	Say $\HC{(A\setminus\{A_i\})} = \HC{A}$.  Then, by \Cref{valid_cone_ineq}, $A_i^T\x\leq 0$ holds for $\HC{(A\setminus\{A_i\})} = \HC{A}$, so $A_i$ is a non-negative linear combination of some rows of $A\setminus\{A_i\}$.
\end{proof}

As before, the converse will fail if we can combine rows of $A$ in a non-trivial way to get $\0$.  For what cones does this occur?  Well, it would be necessary that the following holds for some $\y$:
\[ \y^T\x \leq 0,\quad -\y^T\x\leq 0 \]
But this means that $\y^T\x = 0$ holds for every member of the cone.  We can prevent this from occuring by forcing the cone to contain a basis.

\begin{Def}[Full-Dimensional Cones]
	A cone is called \textit{full-dimensional} if it contains a basis (i.e. $d$ linearly-independent vectors).
\end{Def}

The most important property of a basis $B$ that we shall use is:
\begin{equation}
	\y^T B = \0 \Rightarrow \y = \0 \label{basis_li}
\end{equation}

\begin{Prop} \label{a_full_d}The following statements are equivalent.
	\begin{enumerate}
		\item $\HC{A}$ is full-dimensional.
		\item $\t\geq\0,\,\t\neq\0,\; [\t^T A=\0 \Rightarrow \t=\0]$
	\end{enumerate}
\end{Prop}

\begin{proof}
	$(\neg 1\Rightarrow \neg 2)$.  If $\HC{A}$ is not full-dimensional, then there is some $\y$ so that for every $\x$ the cone $\y^T\x= 0$.  Then, by \Cref{valid_cone_ineq}, we'd have some non-negative $\t_1,\t_2$ such that $\t_1^T A = \y$ and $\t_2^T A = -\y$, in which case $\t_1 + \t_2$ is a counter example to $(2)$.

	$(\neg 2\Rightarrow \neg 1)$.  Suppose $\t\geq\0$, $\t^T A =\0$, and $\t\neq\0$.  Since $\0\not\in A$, at least two elements of $\y$ are non-zero, say one is $y_i$.  Then $\0 = y_i A_i + (\y-y_i\e_i)^T A$, which then means both $A_i\x\leq 0$ and $-A_i\x\leq 0$ holds for $\HC{A}$, in which case it is not full dimensional.
\end{proof}

\begin{Prop}\label{min_hcone_generators}
	Suppose that $\HC{A}$ is full-dimensional.  Then the following two statements are equivalent:
	\begin{enumerate}
		\item A is minimal
		\item $\t\geq\0,\; [A_i=\t^T A \Rightarrow \t=\e_i]$
	\end{enumerate}
\end{Prop}

\begin{proof}
	$(\neg 1 \Rightarrow \neg 2)$ is \Cref{a_not_minimal}.  So suppose that $\t\geq\0$, and $A_i=\t^T A$.  If $0\leq t_i < 1$, then $A_i = (\t-t_i\e_i)^T A/(1-t_i)$, and $\HC{A}=\HC{(A\setminus\set{A_I})}$, which would mean that $A$ is not minimal.  Suppose that $t_i\geq 1$.  Then $\t-\e_i\geq\0$, and $\0=(\t-\e_i)^TA$.  Because $A$ is full-dimensional, by \Cref{a_full_d}, $\0=\t-\e_i$, so $\t=\e_i$.
\end{proof}

\begin{Prop}\label{min_hcones_vcones}
	The following two statements are equivalent:
	\begin{enumerate}
		\item $\HC{A}$ is full dimensional and $A$ is minimal
		\item $\cone(A^T)$ is pointed and $A$ is minimal
	\end{enumerate}
\end{Prop}

\begin{proof}
	This follows from the nearly identical form of $(2)$ in \Cref{min_hcone_generators} and \Cref{min_vcone_generators}.
\end{proof}

In order to create an equivalence criterion like \nameref{eq_hc_vc}, we use the following result.

\begin{Thm}[Dual Cone]\label{dual_cone}
	\[ \HC{A} = \HC{A'} \Leftrightarrow \cone(A^T) = \cone(A'^T) \]
\end{Thm}

\begin{proof}
	First suppose that $\cone(A^T) = \cone(A'^T)$.  Then there exists a non-negative matrix $B$ such that $A'^T = A^TB$.  Then $A\x \leq \0 \Rightarrow B^TA\x\leq \0 \Rightarrow A'\x\leq\0$.  Precisely the same reasoning shows that $A'\x\leq\0 \Rightarrow A\x\leq\0$, and we conclude that $\cone(A^T) = \cone(A'^T) \Rightarrow \HC{A} = \HC{A'}$.

	Next suppose that $\cone(A^T) \neq \cone(A'^T)$, that is, let $\z \in \cone(A^T), \z \not\in\cone(A'^T)$.  We must show that $\HC{A} \neq \HC{A'}$.  By the Farkas Lemma, we have a $\y$ such that $\ip{\y}{\z} > 0,\; A'\y \leq \0$.  Clearly this means that $\y \in \HC{A'}$.  Since $\z \in \cone(A)$, there is some $(\t \geq \0): \z^T = \t^T A$.  Then if $A\y\leq\0$, we would have $\ip{\y}{\z} = \t^T A\y \leq 0 < \ip{\y}{\z}$, a contradiction.  So we conclude that $\y\not\in\HC{A}$.
\end{proof}

\begin{Prop}\label{min_full_dim_generators}
	Suppose that $A$ is minimal, and $\HC{A} = \HC{A'}$ is full-dimensional.  Then $A\sqsubseteq A'$.  It follows that if $A'$ is also minimal, then $A\simeq A'$.
\end{Prop}

\begin{proof}
	By \Cref{min_hcones_vcones} and \Cref{dual_cone}, \Cref{min_full_dim_generators} is true if it is true for cones, which is shown in \nameref{min_pointed_generators}.
\end{proof}

Say we know that $C = \HC{A} = \cone(V)$ is full-dimensional, with $A$ minimal.  We have another set $A'$ and let $C' = \HC{A'}$.  Then we can test if $C' = C$.  The following summarizes the situation:
\begin{alignat*}{2}
	 & A'V\leq\0 \;        & \Rightarrow & \; C \subseteq C'   \\
	 & V \sqsubseteq V' \; & \Rightarrow & \; C'\subseteq C    \\
	 & C' = C \;           & \Rightarrow & \; A \sqsubseteq A' \\
	 & C' = C \;           & \Rightarrow & \; A'V\leq\0
\end{alignat*}

\begin{EqCriteria}[V-Cone $\to$ H-Cone]\label{eq_vc_hc}
	Say $H$ is a minimal generating set of constraints for the full-dimensional H-Cone $C$, and suppose $C = \cone(V) = \HC{A}$.  Then
	\[ C = \HC{A'} \;\Leftrightarrow\; A'V\leq\0,\, A \sqsubseteq A' \]
\end{EqCriteria}

\begin{Test}[H-Cone $\to$ V-Cone]\label{test_vc_to_hc}
	We now have a method for testing the program.  First, we hand-craft a V-Cone $\cone(V)$ based on minimal set $A$ for some pointed H-Cone. We then run our program to get a set $A'$, with the alleged property that $\cone(V) = \HC{A'}$.  If we confirm \Cref{eq_vc_hc}, then our program has succeeded.
\end{Test}

\begin{Remark}
	Can we test the program for non-full-dimensional cones?  (TODO finish this remark).
	%Yes, but again, it is slightly more complicated.  Instead of prior knowledge of a minimal generating of constraints set for the cone, we also need to know what the largest set of independent constraints $B$ such that $B\x=\0$ is valid for the cone.  If we project away constraints from $A$ not orthogonal to all members of $B$, then we will have a pointed cone.  This can be done with a modified fourier-motzkin elimination.  Given another set $A'$, we may project away this subspace from $V'$ using a projection matrix, and use \Cref{test_hc_to_vc}.  Then we need to see if $\cone(V')$ spans $L$.  This can be done with a modified fourier-motzkin elimination, but unfortunately we are trying to test the implementation of fourier-motzkin elimination.

	As of now this is left as a possible future extension of the program.
\end{Remark}

\begin{Remark}
	While not important for testing the program, one may ask if full-dimensional H-Cones are the only cones with essentially unique generating setsof constraints .  The answer is no, for any set of the form $\y^T \x = c$ has an essentially unique generating of constraints.  However, this is the only exception.  It isn't hard to see that, given indpendent constraints of the form $A\x=\0$, if $A$ has more than two rows, then, for any non-singular $B$, $BA\x=\0$ is an equivalent constraint.  So, technically, the \Cref{test_hc_to_vc} would work for hyperplanes.
\end{Remark}

\paragraph{Generalizing to Polyhedra}  In the following sections we generalize \Cref{test_hc_to_vc} and \Cref{test_vc_to_hc} to polyhedra.

\section{Testing H-Polyhedron $\to$ V-Polyhedron}

Say we have an H-Polyhedron $P_{A,\b} = \HP{A}{\b}$, and wish to check that our program correctly calculates a $V'$ and $U'$ such that $P_{A,\b} = \VP{U'}{V'}$.  Again, we shall use the notion of minimality and show that under certain circumstances we can use minimal sets to demonstrate the validity of our algorithm.  First, we consider the case of a V-Polyhedron with no cone.

\subsection{Polytopes}

First we consider the special case of a V-Polyhedron given by $P = \conv(V)$.

\begin{Def}[Minimal Set for Polytopes]
	A set $V$ is called \textit{minimal} for the polytope $\conv(V)$ if:
	\[(\forall \v\in V)\; \conv(V\setminus\set{\v}) \subset \conv(V)\]
\end{Def}

\begin{Prop}\label{min_conv}
	$V$ is minimal for $\conv(V)$ if and only if $V$ is the set of vertices of $\conv(V)$.
\end{Prop}

We will need:

\begin{Prop}\label{conv_conv}
	A convex combination of convex combinations is another convex combination
\end{Prop}

\begin{proof}
	Let $\Lambda$ represent a collection of convex combinations, that is, $\vec{1}^T\Lambda = \vec{1}^T$, and let $\blambda\geq\0,\,\1^T\blambda = 1$ be a convex combinator.  Then $\Lambda\blambda = \blambda'$ where $\blambda'\geq\0,\,\1^T\blambda'=1$.  That $\blambda'\geq\0$ is clear, then just note that $\1^T\blambda' = \1^T\Lambda\blambda = \1^T\blambda = 1$.
\end{proof}

\begin{proof}[Proof of \Cref{min_conv}]
	First, suppose that $V$ is not minimal.  Then there is a $v\in V$ that satisfies $\conv(V\setminus\set{\v}) = \conv(V)$.  Denote $V'=V\setminus\set{\v}$.  Then $\v=V'\blambda'$, where there is some $\lambda_i$ with $0 < \lambda_i < 1$.  Let $\u = V'(\e_i-\blambda')$.  Then
	\[ \v-\lambda_i\u = V'\blambda' - \lambda_iV'(\e_i-\blambda')
		= (1-\lambda_i)V'\blambda' + \lambda_iV'\e_i\]
	By \Cref{conv_conv}, the right hand side of this equation is a convex combination of members of $V'$, so $\v-\lambda_i\u \in \conv(V')$.   Similarly,
	\[ \v+\lambda_i\u = V'\blambda' - \lambda_iV'(\e_i-\blambda') = V'(\blambda'-\lambda_i\e_i) + V'(\lambda_i\blambda') \]
	Consider $(\blambda'-\lambda_i\e_i)$.  Note that this expression is non-negative, and sums to $1-\lambda_i$.  Next note that $\lambda_i\blambda'$ is non-negative, and sums to $\lambda_i$.  This means that the right hand side of the equation is a convex combination of $V'$, so $\v+\lambda_i\u\in\conv(V')$, and $\v$ is not a vertex.\\
	Next, suppose that $\v\in V$ is not a vertex, and let $V'=V\setminus\set{\v}$.  Then there is some non-zero $\u$ such that $\v+\u\in\conv(V)$, $\v-\u\in\conv(V)$.  First, let $\alpha,\beta > 0$, and consider $\v+\alpha\u$ and $\v-\beta\u$.  Observe that
	\[ \frac{\beta(\v+\alpha\u)}{\alpha+\beta} + \frac{\alpha(\v-\beta\u)}{\alpha+\beta} =
		\frac{\alpha\v+\beta\v}{\alpha+\beta} = \v \]
	This shows that we can positively scale $\alpha$ and $\beta$, and still get $\v$ as a convex combination of the result.  So we search for positive $\alpha$ and $\beta$ that give a point of $\conv(V')$, which by \Cref{conv_conv} shows that $\v\in\conv(V')$ so $V$ is not minimal.  First observe that $\v+\u = V\blambda$ for some $\blambda$.  Then let $\blambda' = \blambda - \lambda_i\e_i$, so $\u+\v = V'\blambda' + \lambda_i\v$, and $\u = V'(\blambda') + (\lambda_i-1)\v$  Then
	\[ \v + \alpha\u = \v + \alpha(\lambda_i-1)\v + \alpha V'\blambda' \]
	So we let $\alpha = 1/(1-\lambda_i)$, and the term in $\v$ disappears, while $\blambda'/(1-\lambda_i)$ is a convex combination.  Similarly, we have $\v-\u = V\bmu$, and $\u = \v(1-\mu_i)-V'\bmu'$.  Then
	\[\v - \beta\u = \v(1-\beta(1-\mu_i)) + \beta V'\bmu' \]
	So let $\beta = 1/(1-\mu_i)$, so the right hand side is a convex combination of members of $V'$.
\end{proof}

\subsection{Characterstic Cone}

Now we consider the set $\cone(U)$ in $\cone(U) + \conv(V)$.  The next proposition shows that it is essntially unique for any given Polyhedron.

\begin{Prop}[Characterstic Cone]\label{characteristic_cone}
	Suppose that $P = \HP{A}{b} = \VP{U}{V}$.  Then the following three statements are equivalent:
	\begin{enumerate}
		\item $A\r\leq\0$
		\item $(\forall \x\in P)(\forall \alpha > 0)\;\x + \alpha\r \in P$
		\item $\r \in \cone(U)$
	\end{enumerate}
\end{Prop}

\begin{proof}
	$(1 \Rightarrow 2)$. $\x\in P$ means that $A\x\leq\b$, and $A\r\leq\0$ means that $A(\x+\alpha\r) \leq A\x \leq \b$.\\
	$(\neg 1 \Rightarrow \neg 2)$.  Suppose $\ip{A_i}{\r} > 0$, then let $\alpha > (b_i - \ip{A_i}{\x})/\ip{A_i}{\r}$.  We have:
	\[ \ip{A_i}{\x + \alpha\r} > \ip{A_i}{\x} +
		\frac{b_i\ip{A_i}{\r} - \ip{A_i}{\x}\ip{A_i}{\r}}{\ip{A_i}{\r}} = b_i \]
	$(3 \Rightarrow 2)$.  This is essentially the definition of $\VP{U}{V}$.\\
	$(2 \Rightarrow 3)$.  Now for the real work.  Suppose that (2) holds, but $\r\not\in\cone(U)$.  Then by the Farkas Lemma, we have a $\y$ that satisfies $(\forall \r\in U)\,\ip{\r}{\y}\leq 0,\; \ip{\y}{\r} > 0$.  From (2) we construct a sequence: $(\x_n) = \v+n\cdot\r$.  Then it is clear that the sequence $\ip{\y}{\x_n} \to \infty$.  It is also clear that $(\forall n)\,\x_n \in P$.  We now need the following:
	\begin{Prop}\label{max_linear_func}
		A linear, real-valued function on the set $\conv(V)$ achieves its maximal value at some $\bar\v \in V$.
	\end{Prop}
	\begin{proof}
		To see this is true, suppose that the linear function is given by $\ip{\y}{\cdot}$, and that $\bar\v$ is an element of $V$ such that $(\forall \v \in V)\,\ip{\y}{\bar\v} \geq \ip{\y}{\v}$.  Then, for any $\r \in \conv(V)$, $\r = \sum_{\v\in V} \lambda_v\v$ where $\sum \lambda_v = 1 \Rightarrow \lambda_v \leq 1$, and it follows
		\[\ip{\y}{\r} = \ip{\y}{\sum_{\v\in V}\lambda_v v} = \sum_{v\in V} \lambda_v\ip{\y}{\v}
			\leq \sum_{v\in V}\lambda_v\ip{\y}{\bar\v} = \ip{\y}{\bar\v} \]
	\end{proof}
	Now consider the maximum value of the function $\ip{\y}{\cdot}$ on $P$.  Since any element of $P$ can be written $\r + \v \st \r\in\cone(U),\,\v\in\conv(V)$, and $(\forall\r\in U) \ip{\y}{\r} \leq 0$, we can find the maximum value on $\conv(V)$.  However, $\ip{\y}{\cdot}$ achievs its maximal value on $\conv(V)$ at some $\bar\v\in V$, which is a contradiction with the fact that $\ip{\y}{\x_n} \to \infty$, so we conclude that $\r\in\cone(U)$.
\end{proof}

\begin{Remark}[Characteristic Cone]\label{re_characteristic_cone}  Note that $(2)$ in the proof above is independent of $A$ and $U$.  This means that the cone of a polyhedron is independent of its representation, i.e. if $\VP{U}{V} = \VP{U'}{V'}$, then $\cone(U) = \cone(U')$, while it is not necessarily true that $\conv(V) = \conv(V')$.  Similarly, if $\HP{A}{\b} = \HP{A'}{\b'}$, the it holds that $\HC{A} = \HC{A'}$.
\end{Remark}

\subsection{Minimal V-Polyhedra Pairs}

\begin{Def}
	A pair $(U,V)$ is said to be \textit{minimal} for $\cone(U) + \conv(V)$ if
	\begin{align}
		 & (\forall \u\in U)\;\cone(U\setminus\set{\u}) \subset \cone(U) + \conv(V) \\
		 & (\forall \v\in V)\;\cone(V\setminus\set{\v}) \subset \cone(U) + \conv(V)
	\end{align}
\end{Def}

As before, the pair may not be essentially unique.  This can happen if $U$ is not pointed.  So we will consider only pointed cones for $\cone(U)$.

\begin{Prop}\label{u_min}
	If $(U,V)$ is minimal, then $U$ is minimal for $\cone(U)$.
\end{Prop}

\begin{proof}
	By \Cref{re_characteristic_cone}, $\cone(U) + \conv(V) = \cone(U') + \conv(V)$ if and only if $\cone(U) = \cone(U')$.  So this means that the minimality of $U$ is only dependent on $U$.
\end{proof}

Now we consider the vertices of $\cone(U) + \conv(V)$.

\begin{Prop}\label{v_t_must_be_z}
	If $\v$ is a vertex of $\VP{U}{V}$, then $[\v = U\t + V\blambda] \Rightarrow \t = \0$.
\end{Prop}

\begin{proof}
	If $\v$ can be written with some non-zero contribution from $\cone(U)$, then you may decrease this contribution by some amount while staying in $\cone(U) + \conv(V)$, and you may increase the contribution by the same amount, so $\v$ is not a vertex.
\end{proof}

It will be useful to refer to the property of a set $V$ such that no member of $V$ may be written with a non-zero contribution from $\cone(U)$.  We will call it $U$-free.

\begin{Prop}\label{v_is_vert}
	If $\v$ is a vertex of $\VP{U}{V}$, then $\v$ is a vertex of $\conv(V)$.
\end{Prop}

\begin{proof}
	By \Cref{v_t_must_be_z}, $\v\in\conv(V)$.  If $\v$ is not a vertex of $\conv(V)$, then because $\conv(V) \subseteq \cone(U) + \conv(V)$ it can't be a vertex of $P$.
\end{proof}

Now we can show the following.
\begin{Prop}\label{v_min}
	Suppose that $(U,V)$ is a minimal pair for $\VP{U}{V}$.  Then $V$ is the set of vertices of $\VP{U}{V}$.
\end{Prop}

\begin{proof}
	By \Cref{v_t_must_be_z}, if $\v$ is a vertex of $P$, then it must be a vertex of $V$.  Clearly, $V$ is minimal for $V$, and is precisely the vertices of $\conv(V)$.  The only question is if the vertices of $V$ are the vertices of $P$.  Suppose that $\v$ is a vertex of $\conv(V)$.  Then we must show that for any $\u\neq\0$, if $\v+\u\in P$ then $\v-\u\not\in P$.  Suppose that $\u\in\cone(U)$.  Then, since $V$ is $U$-free, $\v-\u\not\in P$, otherwise $\v=(\v-\u)+\u$ and $V$ is not $U$-free.  If $\u\not\in\cone(U)$, then if $\v+\u\in P$, $\v+\u\in\conv(V)$.  Then because $\v$ is a vertex of $\conv(V)$, $\v-\u\not\in\conv(V)$.
\end{proof}

\begin{Prop}
	Let $P = \cone(U)+ \cone(V)$.  Then the following are equivalent
	\begin{enumerate}
		\item $(U,V)$ is minimal for $P$
		\item $U$ is minimal for $\cone(U)$, $V$ is the vertex set of $P$
		\item $U$ is minimal for $\cone(U)$, $V$ is the vertex set of $\conv(V)$, and $V$ is $U$-free
	\end{enumerate}
\end{Prop}

\begin{proof}
	$(1 \Rightarrow 2)$.  This combines the results of \Cref{u_min} and \Cref{v_min}\\
	$(2 \Rightarrow 3)$.  That $V$ is $U$-free follows from \Cref{v_t_must_be_z}.  By \Cref{v_is_vert}, the vertex set of $P$ is a subset of the vertices of $\conv(V)$.  Let $\v$ be a vertex of $\conv(V)$, we must show that it is a vertex of $P$.  Because it is a vertex of $\conv(V)$, if $\v+\u\in\conv(V)$ then $\v-\u\not\in\conv(V)$.  Say $\v+\u\in\conv(V)+\cone(U)$.  Then $\u$ must have some non-zero contribution of $\cone(U)$.  If $\v-\u\in P$, then $\v$ could be written as $(\v+\u)/2 + (\v-\u)/2$, which has an overall positive contribution from $\cone(U)$, meaning that $V$ is not $U$-free.\\
	$(3 \Rightarrow 1)$.  Since $V$ is the vertex set of $\conv(V)$, if $\v\in V$ is also in $\VP{U}{V\setminus\set{\v}}$, then $\v$ can be written with a non-negative contribution from $\cone(U)$, so $V$ is not $U$-free.  Next let $\u\in U$, and $U'=U\setminus\set{\u}$.  We must find a point in $\VP{U}{V}$ that is not in $\VP{U'}{V}$.  Because $\u \not\in\cone(U')$, there is an $\x$ that satisfies: $\x^T U' \leq \0$, and $\x^T \u > 0$.  By \Cref{max_linear_func}, there is some maximum value $c$ such that $(\forall \x\in\conv(V)) \x^T \u <= c$.  This means that $\set{\x^T \y : \y \in \VP{U'}{V}}$ is upper-bounded by $c$.  But the set $\set{\x^T \y : \y \in \VP{U}{V}}$ is unbounded, since $\x^T \u > 0$.  So we can conlude that $\VP{U'}{V} \subset \VP{U}{V}$.  We conclude that $(U,V)$ are minimal.
\end{proof}

Now we see that the minimal pairs for V-Polyhedra are essentially unique.

\begin{Prop}
	Let $(U,V)$ be minimal for $P = \VP{U}{V} = \VP{U'}{V'}$.  Then $U\sqsubseteq U'$, and $V\subseteq V'$.
\end{Prop}

\begin{proof}
	Since $\cone(U) = \cone(U')$, and $U$ is minimal for $\cone(U)$, by \Cref{eq_hc_vc} $U\sqsubseteq U'$.  By \Cref{v_is_vert} every vertex of $P$ must be a vertex of $V'$, and because $V$ contains precisely the vertices of $P$, $V\subseteq V'$.
\end{proof}

Say we know that $P = \VP{U}{V} = \HP{A}{\b}$, with $U,V$ minimal, and $U$ pointed.  We have another pair $(U',V')$, and let $P'=\VP{U'}{V'}$.  We want to test if $P = P'$.  We have the following:
\begin{alignat*}{2}
	 & AU'\leq\0 \;        & \Rightarrow & \; \cone(U') \subseteq \cone(U) \\
	 & AV'\leq\b \;        & \Rightarrow & \; \conv(V') \subseteq P        \\
	 & U \sqsubseteq U' \; & \Rightarrow & \; \cone(U) \subseteq \cone(U') \\
	 & V \subseteq V'   \; & \Rightarrow & \; \conv(V) \subseteq \conv(V') \\
	 & P' = P \;           & \Rightarrow & \; AU\leq\0                     \\
	 & P' = P \;           & \Rightarrow & \; AV\leq\b                     \\
	 & P' = P \;           & \Rightarrow & \; U \sqsubseteq U'             \\
	 & P' = P \;           & \Rightarrow & \; V \subseteq V'
\end{alignat*}

The first two lines imply that $P'\subseteq P$, while the next two imply that $P\subseteq P'$.  We now have the ability to create an equivalence criteria.

\begin{EqCriteria}[V-Cone $\to$ H-Cone]\label{eq_hp_vp}
	Say $(U,V)$ is a minimal pair for $P = \HP{A}{\b}$ (with pointed $\cone(U)$), and suppose $P' = \cone(U') + \conv(V')$.  Then
	\[ P = P' \;\Leftrightarrow\; AU\leq\0,\, AV\leq\b,\, V\subseteq V',\, U\sqsubseteq U'\]
\end{EqCriteria}

\begin{Test}[H-Polyhedron $\to$ V-Polyhedron]\label{test_hp_to_vp}
	We now have a method for testing the program.  First, we hand-craft an H-Polyhedron $\HP{A}{\b}$ based on a minimal pair $(U,V)$ for some pointed V-Polyhedron. We then run our program to get a pair $(U',V')$, with the alleged property that $\VP{U'}{V'} = \VP{U}{V}$.  If we confirm \Cref{eq_hp_vp}, then our program has succeeded.
\end{Test}

\section{Testing V-Polyhedron $\to$ H-Polyhedron}
Now we suppose we have a V-Polyhedron $P_{U,V} = \VP{U}{V}$, and would like to test the program which returns a matrix-vector pair $A',\b'$ where supposedly $P_{U,V} = \HP{A'}{\b'}$.  Again, we will start off with a pair $A,\b$ where we know that $P_{U,V} = \HP{A}{\b}$, where $A,\b$ satisfy some nice properties, and use those properties to test if $P_{U,V} = \HP{A'}{\b'}$.

\begin{Def}[Minimal H-Pair]
	The pair $(A,\b)$ is called \textit{minimal} for $\HP{A}{\b}$, if, for any row $(A_i,b_i)$, letting $(A',\b')$ be $(A,\b)$ with the $i$-th row deleted, $\HP{A}{\b} \supset \HP{A'}{\b'}$.
\end{Def}

To characterize Minimal H-Pairs, we will need a new form of the Farkas Lemma.

\begin{Thm}[Farkas Lemma 2]\label{farkas_lemma2}
	\[ (\exists \t\geq\0) \t^T A = \y,\, \t^T\b \leq c \Leftrightarrow
		\begin{cases}
			(\forall \x) A\x\leq \0 \Rightarrow \y^T\x \leq 0 \textbf{ and } \\
			(\forall \x) A\x\leq \b \Rightarrow \y^T\x \leq c
		\end{cases}
	\]
\end{Thm}

\begin{proof}
	First we note that
	\begin{alignat*}{2}
		 & \exists \t\geq\0,\; \t^TA =\y,\,\t^T\b\leq c & \Leftrightarrow \\
		 & \exists \t\geq\0,\; \t^T\pmb A                                 \\ 0\pme  =\y,\,\t^T \pmb \b \\ 1\pme = c \quad& \Leftrightarrow \\
		 & \exists \t\geq\0,\; \t^T\pmb -\b             & A               \\ -1 & 0 \pme = (-c,\y)
	\end{alignat*}
	If we negate the right hand side of \nameref{farkas_lemma}, then we get that
	\begin{alignat*}{2}
		 & \exists \t\geq\0,\; \t^T\pmb -\b                                            & A \\ -1 & 0 \pme = (-c,\y) & \Leftrightarrow \\
		 & \forall \x,x_0\;  \pmb -\b                                                  & A \\ -1 & 0 \pme\pmb x_0 \\ \x\pme \leq \0 \Rightarrow \ip{(-c,\y)}{(x_0,\x)} \leq \0 \quad & \Leftrightarrow                                       \\
		 & \forall x_0\geq 0,\;  A\x\leq x_0\b \;\Rightarrow \;\y^T\x \leq x_0 \cdot c
	\end{alignat*}
	Taking the case that $x_0 = 0$ and $x_0 > 0$ separately, you get the proposition.
\end{proof}

\begin{Prop}\label{ab_not_minimal}
	Suppose that $(A,\b)$ is not minimal for some $\HP{A}{\b}$.  Then there is a row $(A_i,b_i)$ for which the following holds.  Let $(A',\b')$ be $(A,\b)$ with the $i$-th row deleted.  Then there is a $\t'\geq\0$ such that $\t'^T A' = A_i$, $\t'^T \b' \leq b_i$.
\end{Prop}

\begin{proof}
	Since $(A,\b)$ is not minimal, there is such an $(A_i,b_i)$ and $(A',\b')$ such that $\HP{A}{\b} = \HP{A'}{\b'}$.  In the right hand side of \nameref{farkas_lemma2}, the conditions are satisfied with $A := A'$, $\b := \b'$, $\y := A_i$, $c := b_i$.
\end{proof}

Is the converse true?  Does it hold that given a $(A,\b)$ which is minimal, the implication of \Cref{ab_not_minimal} fails?  In general, no.  For example, the hyperplane $\ip{\y}{\x} = c$ has a minimal representation $\set{\ip{\y}{\x}\leq c,\,\ip{-\y}{\x}\leq -c}$, but the sum of the rows is $0$, and so $\t':= (2,1)$ satsifes the claim.  In general, we need all $d+1$ rows to be \textit{affinely independent}.

\begin{Def}[Affine Dependence]
	A set $V$ of vectors is called \textit{affinely independent} if, given any $\y\neq\0$, $c\in\R$, there is some $\v\in V$ such that $\y^T\v \neq c$.
\end{Def}

\begin{Def}[Full-Dimensional]
	A polyhedron is called \textit{full-dimensional} if it contains an affinely independent set of vectors.
\end{Def}

\begin{Prop}\label{ab_full_dim}
	If $P = \HP{A}{\b}$ is full dimensional, and $\y^T A = \0$ with $\y\geq\0$, then either $\y = \0$ or $\y^T \b > \0$.
\end{Prop}

\begin{proof}
	Say $\y^T A = \0$, $\y \neq \0$, and $\y^T\b = 0$.  Then suppose $y_i \neq 0$.  Then
	\[y_i A_i + \sum_{j\neq i}y_j A_j = \0,\quad y_i b_i + \sum_{j\neq i} y_j a_j = 0 \]
	So, there are non-negative $\t_1,\t_2$ such that
	\[\t_1^T A = -\t_2^T A,\quad \t_1^T\b = -\t_2^T\b\]
	But then for any $\x\in P$ it must hold that $\t_1^T A \x = \t_1^T \b$.  Since $P$ is full dimensional, it must be that $\t_1 = \0$, then $\y = \0$.
\end{proof}

\begin{Prop}\label{ab_is_minimal}
	Suppose that $(A,\b)$ is minimal for some full-dimensional $\HP{A}{\b}$.  Then let $(A_i,b_i)$ be any row.  If, for some $\t\geq\0$ $\t^TA = A_i$, then either $\t=\e_i$ or $\t^T\b > b_i$.
\end{Prop}

\begin{proof}
	Suppose that $A_i = t_i A_i + \t'^T A'$, and $b_i = t_i b_i + \t'\b'$.  If $0 \leq t_i < 1$, then $A_i = \t'^T A'/(1-t_i)$, and $b_i = \t'^T \b'/(1-t_i)$.  But then $(A,\b)$ is not minimal (the $i$-th row may be deleted without changing the polyhedron).  Say $1\leq t_i$.  Then there is a non-negative $\t''$ with $\t''^T A = 0$, $\t''^T\b = 0$.  By \Cref{ab_full_dim}, $\t'' = \0$, and $\t = \e_i$.
\end{proof}

Now we intend to use these properties of full-dimensionality and minimality to let us reduce the problem to one of cones.

\begin{Prop}\label{homogenization_cone}
	The following statements are equivalent:
	\begin{enumerate}
		\item $\HP{A}{\b} = \HP{A'}{\b'}$
		\item $\set{\xx \big| \pmb -1 & \0 \\ -\b & A \pme \xx \leq \0} =
			      \set{\xx \big| \pmb -1 & \0 \\ -\b' & A' \pme \xx \leq \0}$
	\end{enumerate}
\end{Prop}

\begin{proof}
	$(2 \Rightarrow 1)$.  Just set $x_0 = 1$, and move $\b,\b'$ to the right side of the inequalities.
	$(\neg 2 \Rightarrow \neg 1)$.  Suppose that:
	\[ \pmb -1 & \0 \\ -\b & A \pme \xx \leq \0,\quad
		\pmb -1 & \0 \\ -\b' & A' \pme \xx \not\leq \0 \]
	Observe that, by the way these sets are constructed, $x_0 \geq 0$.  If $x_0 = 0$, then we have $\HC{A} \neq \HC{A'}$, which, by \Cref{characteristic_cone} means that that $A$ and $A'$ don't create the same characterstic cone, so $\HP{A}{\b} \neq \HP{A'}{\b'}$.  If $x_0 > 0$, then we have:
	\[ A\x \leq x_0\b,\;A'\x\not\leq x_0\b' \Rightarrow A(\x/x_0)\leq\b,\;A'(\x/x_0)\not\leq\b' \]
	So $\HP{A}{\b} \neq \HP{A'}{\b'}$.
\end{proof}

Now, combining the results of \Nameref{characteristic_cone} and \cref{homogenization_cone}, we have the following result:

\begin{Prop}\label{dual_homogenization_cone}
	The following two statement are equivalent:
	\begin{enumerate}
		\item $\HP{A}{\b} = \HP{A'}{\b'}$
		\item $\cone \pmb -\b^T & -1 \\ A^T & \0 \pme = \cone \pmb -\b'^T & -1 \\ A'^T & \0 \pme$
	\end{enumerate}
\end{Prop}
%\begin{proof} This immediately follows from propositions \ref{homogenization_cone} and \ref{dual cone}.  \end{proof}

\begin{Prop}\label{dual_cone_min}
	If $\HP{A}{\b}$ is minimal and full-dimensional, then $\cone \pmb -\b^T & -1 \\ A^T & \0 \pme$ is minimal and pointed.
\end{Prop}

\begin{proof}
	To see that it is pointed, let
	\[\cone \pmb -\b^T & -1 \\ A^T & \0 \pme (\t,t_0) = \0\]
	If $(\t,t_0)$ is non-zero, then $\t^T A = \0$, which by \Cref{ab_full_dim} means that $-\t^T \b < 0$.  This means that $-\t^T\b -t_0 < 0$.  So $(\t,t_0) = \0$.  To show that it is minimal, by \Nameref{min_vcone_generators}, we only need to show that
	\[ \t\geq\0,\; [(A_i=\t^T A,\,\t^T \b + t_0 = b_i) \Rightarrow \t=\e_i] \]
	By \Cref{ab_is_minimal}, if $\t\neq\e_i$, and $\t^T A = A_i$, then $\t^\b > b_i$, so $\t^T\b + t_0 \> b_i$.  So that means that if $\t^T A = A_i$, then $\t$ mush be $\e_i$.
\end{proof}

\begin{Prop}
	Say $(A,\b)$ is minimal for full-dimensional $\HP{A}{\b}$.  Then if $\HP{A}{\b} = \HP{A'}{\b'}$, then $(A,\b) \sqsubseteq (A',\b')$.
\end{Prop}

\begin{proof}
	By \Cref{dual_homogenization_cone} and \Cref{dual_cone_min}, we have that
	\[ \pmb -\b^T & -1 \\ A^T & 0\pme \sqsubseteq \pmb -\b'^T & -1 \\ A'^T & 0\pme \]
	Because $A$ does not contain any $\0$ rows, it follows that
	\[ \pmb -\b^T \\ A^T \pme \sqsubseteq \pmb -\b'^T \\ A'^T \pme \]
\end{proof}

Say we know that $P = \HP{A}{\b} = \VP{U}{V}$, with $(A,\b)$ minimal, and $P$ full-dimensional.  We have another pair $(A',\b')$, and let $P'=\HP{A'}{\b'}$.  We want to test if $P = P'$.  We have the following:
\begin{alignat*}{2}
	 & A'U\leq\0 \;                \; & \Rightarrow & \; \cone(U') \subseteq \HC{A'} \\
	 & A'V\leq\b \;                   & \Rightarrow & \; \conv(V') \subseteq P'      \\
	 & (A,\b) \sqsubseteq (A',\b') \; & \Rightarrow & P' \subseteq P                 \\
	 & P' = P \;                      & \Rightarrow & \; A'U\leq\0                   \\
	 & P' = P \;                      & \Rightarrow & \; A'V\leq\b                   \\
	 & P' = P \;                      & \Rightarrow & \;(A,\b) \sqsubseteq (A',\b')
\end{alignat*}

The first two lines imply that $P \subseteq P'$, so the first three mean that $P = P'$.  We then have the following equivalence criteria:

\begin{EqCriteria}\label{eq_vp_hp}
	Say $(A,\b)$ is a minimal pair for $P = \HP{A}{\b} = \VP{U}{V}$, and suppose $P' = \HP{A'}{\b'}$.  Then
	\[ P = P' \;\Leftrightarrow\; A'U\leq\0,\, A'V\leq\b,\, (A,\b)\sqsubseteq (A',\b')\]
\end{EqCriteria}

\begin{Test}[V-Polyhedron $\to$ H-Polyhedron]\label{test_vp_to_hp}
	We now have a method for testing the program.  First, we hand-craft a V-Polyhedron $\VP{U}{V}$ based on some minimal pair $(A,\b)$, then run our program to get the pair $(A',\b')$, with the alleged property that $\VP{U}{V} = \HP{A'}{\b'}$.  If we confirm \Cref{eq_vp_hp}, then our program has succeeded.
\end{Test}

\section{\filename{test\_functions.h}}

The following types are defined for running tests of the different algorithms.  They are expected to be given a descriptive name, the object on which the test will be run, and a \lsti{key} with which the result of the test will be compared.  The \lsti{key} object is one of the minimal objects described above.
\lsthconetestcasea
\lstvconetestcasea
\lsthpolytestcaseb
\lstvpolytestcaseb

\section{\filename{test\_functions.cpp}}

The dot-product and norm (in terms of dot product).
\lstoperator
\lstnorm

\lsti{approximately_zero} is used during tests to avoid issues involving floating point rounding errors.  For example, \lsti{1/6.0 * 2.5 - 5/12.0 == 0} will give \lsti{false}, while \lsti{approximately_zero(1/6.0 * 2.5 - 5/12.0)} will return \lsti{true}.  Test cases are used where intermediate calculations don't depend on such high accuracy, and these discrepencies can be ignored.

\lsti{approximately_zero(c) == true} is be denoted $\mli{c} \approx 0$.
\lstapproximatelyzeroa

Tests $c < 0 \lor c \approx 0$.
\lstapproximatelyltzero

Tests $\norm{\v} \approx 0$.  This is be denoted $\v \approx \0$.
\lstapproximatelyzerob

Tests $\u/\norm{\u} - \v/\norm{\v} \approx \0 $.  This is be denoted $\u \simeq \v$.
\lstisequivalent

Tests $\u - \v \approx \0$.  This is be denoted $\u \approx \v$.
\lstisequal

Tests $(\exists \u \in U) \st \v \simeq \u$.
\lsthasequivalentmember

Tests $(\exists \u \in U) \st \v \approx \u$.
\lsthasequalmember

Tests $(\forall v \in V)(\exists \u \in U) \st \v \simeq \u$.  This is be denoted $V \sqsubseteq U$.
\lstsubsetmodeq

Tests $(\forall v \in V)(\exists \u \in U) \st \v \approx \u$.  This is be denoted $V \subseteq U$.
\lstsubset

Given a \mli{Vector constraint} and \mli{Vector ray}, tests if \\
\lsti{approximately_lt_zero(ray * constraint)}.  Note that if the constraint is of the form $\ip{A_i}{\v} \leq b$ for some value $b$, then this tests $\ip{A_i}{\mli{ray}}\leq\0$.
\lstraysatisfieda

Test $A\v \leq \0$
\lstraysatisfiedb

Test $AV \leq \0$
\lstrayssatisfied

Test $\ip{A_i}{\v} \leq b_i$
\lstvecsatisfieda

Test $A\v \leq \b$
\lstvecsatisfiedb

Test $AV \leq \b$
\lstvecssatisfied

Given an H-Cone $C = \HC{A} = \cone(U)$ where $U$ is minimal, and a \lsti{Matrix} $U'$, determines if $C = \cone(U')$.
Similarly, given a V-Cone $C = \cone(U) = \HC{A}$ where $A$ is minimal, and a \lsti{Matrix} $A'$, determines if $C = \HC{A'}$.
\lstequivalentconerep

Given an H-Polytope $P = \HP{A}{\b} = \VP{U}{V}$ where $U$ and $V$ are minimal, and a pair $(U',V')$, determines if $P = \VP{U'}{V'}$.
\lstequivalenthpolyrep

Given a V-Polytope $P = \VP{U}{V} = \HP{A}{\b}$ where $A$ is minimal, and a \lsti{Matrix} $(A',\b')$, determines if $P = \HP{A'}{\b'}$.
\lstequivalentvpolyrep

%\lsthconetestcaseb
%\lstvconetestcaseb
%\lsthpolytestcasea
%\lstvpolytestcasea


